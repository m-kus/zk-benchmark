#!/usr/bin/env bash
. "$(dirname "$0")/../../common/checker-api.bash"

#   The `scarb` command is quite similar to `cargo`, being based on the
#   `cargo` code. But there are various differences, e.g., `--release`
#   needs to come before the `build`/`test` command rather than after.

build() {
    build_rust
}

test() {
    test_rust
    (command cd "$CHECKER/guest" \
        && $dry env scarb  ${releasever:+--release} test "$@") || fail
}

run()   {
    if [ ! -z $certgen ]
    then
        extra_args="--cert-gen"
    else
        extra_args=""
    fi

    run_risc0 mm-cairo "$@" $extra_args;
}

main "$@"
